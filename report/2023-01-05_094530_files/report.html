<html><head> 
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <title>Report</title>
        <script src="https://cdn.staticfile.org/jquery/3.2.1/jquery.min.js"></script>
        <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.22/css/jquery.dataTables.css">
        <style type="text/css">
            .dataframe{font-size:3pt;border:2px solid #b613de; text-align: center;}
            table.dataTable tbody tr.even {
                background-color: #fff0fe ;
            }
            table.dataTable tbody tr.even:hover {
                background-color: #e9a6e4 ;
            }
            .dataframe tr:hover{background:#e8e8e8;cursor:pointer;}

            th:hover{

                color : #6f008b
            }
            th.sorting, th.sorting_asc, th.sorting_desc {
                text-align: center;
                color: #eda3ff
            }
            table.tg {
                margin: 0 auto;
            }
            th {
                text-align: center;
                color: #492152
            }
            .sport_data {
                margin-left: 10px;
            }
            .sport_key {
                color: #9200ab;
                font-size: medium;
                font-style: italic;
                font-family: fangsong;
                font-weight: 600;
                display: inline-block;
            }
            .sport_value {
                color: #ff9800;
                font-size: unset;
                display: unset;
                margin: 10px;
                font-style: oblique;
            }
            .tg  {border-collapse:collapse;border-spacing:0;}
            .tg td{border-color:black;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;
            overflow:hidden;padding:9px 15px;word-break:normal;}
            .tg th{border-color:black;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;
            font-weight:normal;overflow:hidden;padding:9px 15px;word-break:normal;}
            .tg .tg-ycto{background-color:#eadef7;border-color:#8b0987;color:#9710f6;font-family:"Lucida Console", Monaco, monospace !important;
            font-size:20px;font-weight:bold;text-align:center;vertical-align:middle}
            .tg .tg-qq58{background-color:#fff6d9;border-color:#8b0987;color:#ec9d00;font-family:"Lucida Console", Monaco, monospace !important;
            font-size:14px;font-style:italic;text-align:center;vertical-align:top}
            .tg .tg-gmpv{background-color:#eeeaf2;border-color:#8b0987;color:#9317ba;font-family:"Lucida Console", Monaco, monospace !important;
            font-size:14px;font-weight:bold;text-align:center;vertical-align:top}
            .tg .tg-r27s{background-color:#fff6d9;border-color:inherit;text-align:center;vertical-align:top}


        </style>
        <script src="https://cdn.datatables.net/1.10.22/js/jquery.dataTables.min.js" type="text/javascript"></script>

        <script type="text/javascript">
            $(document).ready(function () {

                var type_data = []
                var data = {'index': [], 'sport': [], 'iid': [], 'Inplay': [], 'tnName': [], 'name': [], 'Check Time': [], 'Kickoff Time': [], 'gifs': [], 'mid': [], 'source': [], 'stream url': [], 'Result': [], 'Reason': [], 'Screenshot': []}
                    
                var key_name = Object.keys(data)
                console.log(key_name)
                var len_data = data[key_name[0]].length//動態取得 data 第一個key 名稱的長度
                console.log(len_data)
                var tabel_text = "<table border='1' class='dataframe'><thead><tr style='text-align: right;'>"
                var nowrap_array = ['tnName' , 'name', 'Check Time' , 'Kickoff Time'] // 拿來不換行 的 array

                for (i=0;i<len_data;i++){// 動態把 key取出後, loop增加 th 方式
                    var a = []
                    $.each( key_name, function( key, value ) { // jey 為索引, value 為 data的key名稱

                        
                        if (i==0){ 
                            if ( $.inArray(  value , nowrap_array  ) > -1 ) { // 不換行
                                var newTh = "<th  style='white-space: nowrap;' >"+ value +"</th>"; 
                            }
                            else{
                                var newTh = "<th>"+ value +"</th>"; 
                            }

                        
                            tabel_text = tabel_text + newTh

                        }
                        if (data[value][i].indexOf('.png') > 1){
                            data_ = "<a href=" + data[value][i] +" target='_blank' ><img src=" + data[value][i] + " width='160px' height='80px' ></a>"
                        }
                        else{
                            data_  = data[value][i]
                            if (data_ == 'Pass'){
                                data_ = "<span style='color: #00b107;font-size: large;'>" + data_  + "</span>"
                            }
                            else if  (data_ == 'Fail'){
                                data_ = "<span style='color: #f44336;font-size: large;'>" + data_  + "</span>"
                            }
                            else{// 不換行 
                                //data_ = "<span style='white-space:nowrap;'>" + data_  + "</span>"
                                data_ =  data_ 
                            }
                        
                        }

                        a.push(data_)
                        
                    });
                    
                    type_data.push(a)// 陣列包陣列 ex: [[123],[456]]

                }
                tabel_text = tabel_text + "</tr></thead><tbody><tr><th></th></tr></tbody></table>"
                $('#data').after(tabel_text)
                $('.dataframe').DataTable( {
                    data:  type_data ,
                    "iDisplayLength": 100,
                    //dom:'lBrtip',
                    "bAutoWidth" : true,
                    "searching": true, 
                    "paging": true,
                   "lengthMenu": [30 , 50, 100 ] ,
                    "info":true,
                    "language": {
                        "search": "搜尋:",
                        "paginate": {
                            "first": "第一頁",
                            "previous": "上一頁",
                            "next": "下一頁",
                            "last": "最後一頁"
                        },
                        "info": "顯示第 _START_ 至 _END_ 項結果，共 _TOTAL_ 項",
                        "lengthMenu": "顯示 _MENU_ 項結果",
                    }
                });
                //$('.dataframe.dataTable.no-footer').css('width','120%')
                $('.dataTables_filter input').css('color','black')
                $('.dataTables_filter').css('color','black')


            })

        </script>
        </head> 
        <body>
        <div style="font-size :x-large;
            text-align :center;
            margin :inherit;
            font-weight: bold;
            color: rgb(153 96 255);">動態圖自動化</div>
        <table class="tg">
            <thead>
                <tr>
                    <th class="tg-ycto" colspan="12">失敗率</th>
                </tr>
            </thead>
            <tbody>
            <tr>
                <td class="tg-qq58" colspan="4">滾球  </td>
                <td class="tg-qq58" colspan="4">今日 </td>
                <td class="tg-qq58" colspan="4">早盤  </td>
            </tr>
            <tr>
                <td class="tg-gmpv">足</td>
                <td class="tg-gmpv">籃</td>
                <td class="tg-gmpv">網</td>
                <td class="tg-gmpv">棒</td>
                <td class="tg-gmpv">足</td>
                <td class="tg-gmpv">籃</td>
                <td class="tg-gmpv">網</td>
                <td class="tg-gmpv">棒</td>
                <td class="tg-gmpv">足</td>
                <td class="tg-gmpv">籃</td>
                <td class="tg-gmpv">網</td>
                <td class="tg-gmpv">棒</td>
            </tr>
            <tr> <td class='tg-r27s'>0/0 = 0.0%</td> <td class='tg-r27s'>0/0 = 0.0%</td> <td class='tg-r27s'>0/0 = 0.0%</td> <td class='tg-r27s'>0/0 = 0.0%</td> <td class='tg-r27s'>0/0 = 0.0%</td> <td class='tg-r27s'>0/0 = 0.0%</td> <td class='tg-r27s'>0/0 = 0.0%</td> <td class='tg-r27s'>0/0 = 0.0%</td> <td class='tg-r27s'>0/0 = 0.0%</td> <td class='tg-r27s'>0/0 = 0.0%</td> <td class='tg-r27s'>0/0 = 0.0%</td> <td class='tg-r27s'>0/0 = 0.0%</td></tr>
            </tbody>
            </table>
        <div id="data" style="color: #bbbbbb; display: list-item;"></div>
        </body></html>